include("stdtest.ph");

var g = 0;
var t = 0;

class foo
{
    func new(n:std.int) ... x(n) { g = g + 1; t = t + 1; }
    func new(a:ref foo) ... x(a.x) { g = g + 1; t = t + 1; }
    func delete(){ g = g - 1; }

    func clone():foo { return foo(x); }

    var x:std.int;
}

func f(n:std.int):foo
{
    return foo(n);
}

func main()
{
    test.assert(f(321).clone().x == 321);

    test.assert(g == 0);
    test.assert(t == 4);
}
