include("stdtest.ph");

class foo
{
    func new() ... x(123) { }
    func new(a:ref foo) ... x(a.x) { }
    func delete(){ }

    func clone():foo { return foo(this); }
    func r():ref foo { return this; }

    var x:std.int;
}

func main()
{
    var a = foo().x;
    test.assert(a == 123);

    test.assert(foo().x == 123);

    test.assert(foo().clone().x == 123);
    test.assert(foo().r().x == 123);
}
